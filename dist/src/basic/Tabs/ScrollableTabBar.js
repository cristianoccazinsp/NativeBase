var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.ScrollableTab=void 0;var _react=_interopRequireWildcard(require("react"));var _propTypes=_interopRequireDefault(require("prop-types"));var _createReactClass=_interopRequireDefault(require("create-react-class"));var _lodash=require("lodash");var _shoutem=require("../../theme/shoutem");var _mapPropsToStyleNames=_interopRequireDefault(require("../../utils/mapPropsToStyleNames"));var _platform=_interopRequireDefault(require("./../../theme/variables/platform"));var _TabHeading=require("../TabHeading");var _Text=require("../Text");var _utils=require("../../utils");var _jsxFileName="/Users/cristiano/Desktop/trabajo/zinspector/NativeBase/src/basic/Tabs/ScrollableTabBar.js";function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap();var cacheNodeInterop=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj;}if(obj===null||typeof obj!=="object"&&typeof obj!=="function"){return{default:obj};}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj);}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}newObj.default=obj;if(cache){cache.set(obj,newObj);}return newObj;}var Button=require('./Button');var ReactNative=require('react-native');var View=ReactNative.View,Animated=ReactNative.Animated,StyleSheet=ReactNative.StyleSheet,ScrollView=ReactNative.ScrollView,Platform=ReactNative.Platform,Dimensions=ReactNative.Dimensions;var WINDOW_WIDTH=Dimensions.get('window').width;var ScrollableTabBar=(0,_createReactClass.default)({displayName:"ScrollableTabBar",propTypes:{goToPage:_propTypes.default.func,activeTab:_propTypes.default.number,tabs:_propTypes.default.array,backgroundColor:_propTypes.default.string,activeTextColor:_propTypes.default.string,inactiveTextColor:_propTypes.default.string,scrollOffset:_propTypes.default.number,style:_utils.ViewPropTypes.style,tabStyle:_utils.ViewPropTypes.style,tabsContainerStyle:_utils.ViewPropTypes.style,renderTab:_propTypes.default.func,underlineStyle:_utils.ViewPropTypes.style,onScroll:_propTypes.default.func},contextTypes:{theme:_propTypes.default.object},getDefaultProps:function getDefaultProps(){return{scrollOffset:52,activeTextColor:'navy',inactiveTextColor:'black',backgroundColor:_platform.default.tabDefaultBg,style:{},tabStyle:{},tabsContainerStyle:{},underlineStyle:{},tabFontSize:_platform.default.tabFontSize};},getInitialState:function getInitialState(){this._tabsMeasurements=[];return{_leftTabUnderline:new Animated.Value(0),_widthTabUnderline:new Animated.Value(0),_containerWidth:null};},componentDidMount:function componentDidMount(){this.props.scrollValue.addListener(this.updateView);},updateView:function updateView(offset){var position=Math.floor(offset.value);var pageOffset=offset.value%1;var tabCount=this.props.tabs.length;var lastTabPosition=tabCount-1;if(tabCount===0||offset.value<0||offset.value>lastTabPosition){return;}if(this.necessarilyMeasurementsCompleted(position,position===lastTabPosition)){this.updateTabPanel(position,pageOffset);this.updateTabUnderline(position,pageOffset,tabCount);}},necessarilyMeasurementsCompleted:function necessarilyMeasurementsCompleted(position,isLastTab){return this._tabsMeasurements[position]&&(isLastTab||this._tabsMeasurements[position+1])&&this._tabContainerMeasurements&&this._containerMeasurements;},updateTabPanel:function updateTabPanel(position,pageOffset){var containerWidth=this._containerMeasurements.width;var tabWidth=this._tabsMeasurements[position].width;var nextTabMeasurements=this._tabsMeasurements[position+1];var nextTabWidth=nextTabMeasurements&&nextTabMeasurements.width||0;var tabOffset=this._tabsMeasurements[position].left;var absolutePageOffset=pageOffset*tabWidth;var newScrollX=tabOffset+absolutePageOffset;newScrollX-=(containerWidth-(1-pageOffset)*tabWidth-pageOffset*nextTabWidth)/2;newScrollX=newScrollX>=0?newScrollX:0;if(Platform.OS==='android'){this._scrollView.scrollTo({x:newScrollX,y:0,animated:false});}else{var rightBoundScroll=this._tabContainerMeasurements.width-this._containerMeasurements.width;newScrollX=newScrollX>rightBoundScroll?rightBoundScroll:newScrollX;this._scrollView.scrollTo({x:newScrollX,y:0,animated:false});}},updateTabUnderline:function updateTabUnderline(position,pageOffset,tabCount){var lineLeft=this._tabsMeasurements[position].left;var lineRight=this._tabsMeasurements[position].right;if(position<tabCount-1){var nextTabLeft=this._tabsMeasurements[position+1].left;var nextTabRight=this._tabsMeasurements[position+1].right;var newLineLeft=pageOffset*nextTabLeft+(1-pageOffset)*lineLeft;var newLineRight=pageOffset*nextTabRight+(1-pageOffset)*lineRight;this.state._leftTabUnderline.setValue(newLineLeft);this.state._widthTabUnderline.setValue(newLineRight-newLineLeft);}else{this.state._leftTabUnderline.setValue(lineLeft);this.state._widthTabUnderline.setValue(lineRight-lineLeft);}},renderTab:function renderTab(name,page,isTabActive,onPressHandler,onLayoutHandler,tabStyle,activeTabStyle,textStyle,activeTextStyle,tabHeaderStyle,tabFontSize){var headerContent=typeof name!=='string'?name.props.children:undefined;var _this$props=this.props,activeTextColor=_this$props.activeTextColor,inactiveTextColor=_this$props.inactiveTextColor;var textColor=isTabActive?activeTextColor:inactiveTextColor;var fontWeight=isTabActive?'bold':'normal';if(typeof name==='string'){return _react.default.createElement(Button,{key:name+"_"+page,onPress:function onPress(){return onPressHandler(page);},onLayout:onLayoutHandler,__self:this,__source:{fileName:_jsxFileName,lineNumber:174,columnNumber:9}},_react.default.createElement(_TabHeading.TabHeading,{scrollable:true,style:isTabActive?activeTabStyle:tabStyle,active:isTabActive,__self:this,__source:{fileName:_jsxFileName,lineNumber:179,columnNumber:11}},_react.default.createElement(_Text.Text,{style:[isTabActive?activeTextStyle:textStyle,{fontSize:tabFontSize}],__self:this,__source:{fileName:_jsxFileName,lineNumber:184,columnNumber:13}},name)));}return _react.default.createElement(Button,{key:name+"_"+page,onPress:function onPress(){return onPressHandler(page);},onLayout:onLayoutHandler,__self:this,__source:{fileName:_jsxFileName,lineNumber:197,columnNumber:7}},_react.default.createElement(_TabHeading.TabHeading,{scrollable:true,style:tabHeaderStyle,active:isTabActive,__self:this,__source:{fileName:_jsxFileName,lineNumber:202,columnNumber:9}},headerContent));},measureTab:function measureTab(page,event){var _event$nativeEvent$la=event.nativeEvent.layout,x=_event$nativeEvent$la.x,width=_event$nativeEvent$la.width,height=_event$nativeEvent$la.height;this._tabsMeasurements[page]={left:x,right:x+width,width:width,height:height};this.updateView({value:this.props.scrollValue._value});},render:function render(){var _this=this;var variables=this.context.theme?this.context.theme['@@shoutem.theme/themeStyle'].variables:_platform.default;var tabUnderlineStyle={position:'absolute',height:4,backgroundColor:variables.topTabBarActiveBorderColor,bottom:0};var dynamicTabUnderline={left:this.state._leftTabUnderline,width:this.state._widthTabUnderline};return _react.default.createElement(View,{style:[styles.container,{backgroundColor:this.props.backgroundColor},this.props.style],onLayout:this.onContainerLayout,__self:this,__source:{fileName:_jsxFileName,lineNumber:233,columnNumber:7}},_react.default.createElement(ScrollView,{automaticallyAdjustContentInsets:false,ref:function ref(scrollView){_this._scrollView=scrollView;},horizontal:true,showsHorizontalScrollIndicator:false,showsVerticalScrollIndicator:false,directionalLockEnabled:true,onScroll:this.props.onScroll,bounces:false,scrollsToTop:false,__self:this,__source:{fileName:_jsxFileName,lineNumber:241,columnNumber:9}},_react.default.createElement(View,{style:[styles.tabs,{width:this.state._containerWidth},this.props.tabsContainerStyle],ref:'tabContainer',onLayout:this.onTabContainerLayout,__self:this,__source:{fileName:_jsxFileName,lineNumber:254,columnNumber:11}},this.props.tabs.map(function(name,page){var isTabActive=_this.props.activeTab===page;var renderTab=_this.props.renderTab||_this.renderTab;return renderTab(name,page,isTabActive,_this.props.goToPage,_this.measureTab.bind(_this,page),_this.props.tabStyle[page],_this.props.activeTabStyle[page],_this.props.textStyle[page],_this.props.activeTextStyle[page],_this.props.tabHeaderStyle[page],variables.tabFontSize);}),_react.default.createElement(Animated.View,{style:[tabUnderlineStyle,dynamicTabUnderline,this.props.underlineStyle],__self:this,__source:{fileName:_jsxFileName,lineNumber:280,columnNumber:13}}))));},UNSAFE_componentWillReceiveProps:function UNSAFE_componentWillReceiveProps(nextProps){if(!(0,_lodash.isEqual)(this.props.tabs,nextProps.tabs)&&this.state._containerWidth){this.setState({_containerWidth:null});}},onTabContainerLayout:function onTabContainerLayout(e){this._tabContainerMeasurements=e.nativeEvent.layout;var width=this._tabContainerMeasurements.width;if(width<WINDOW_WIDTH){width=WINDOW_WIDTH;}this.setState({_containerWidth:width});this.updateView({value:this.props.scrollValue._value});},onContainerLayout:function onContainerLayout(e){this._containerMeasurements=e.nativeEvent.layout;this.updateView({value:this.props.scrollValue._value});}});var StyledTab=(0,_shoutem.connectStyle)('NativeBase.ScrollableTab',{},_mapPropsToStyleNames.default)(ScrollableTabBar);exports.ScrollableTab=StyledTab;var styles=StyleSheet.create({tab:{height:49,alignItems:'center',justifyContent:'center',paddingLeft:20,paddingRight:20},container:{height:50,borderWidth:1,borderTopWidth:0,borderLeftWidth:0,borderRightWidth:0,borderColor:'#ccc'},tabs:{flexDirection:'row',justifyContent:'space-around'}});
//# sourceMappingURL=ScrollableTabBar.js.map