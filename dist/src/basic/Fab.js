var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.Fab=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _lodash=require("lodash");var _shoutem=require("../theme/shoutem");var _platform=_interopRequireDefault(require("../theme/variables/platform"));var _commonColor=require("../theme/variables/commonColor");var _computeProps=_interopRequireDefault(require("../utils/computeProps"));var _mapPropsToStyleNames=_interopRequireDefault(require("../utils/mapPropsToStyleNames"));var _Button=require("./Button");var _jsxFileName="/Users/cristiano/Desktop/trabajo/zinspector/NativeBase/src/basic/Fab.js";function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap();var cacheNodeInterop=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj;}if(obj===null||typeof obj!=="object"&&typeof obj!=="function"){return{default:obj};}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj);}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}newObj.default=obj;if(cache){cache.set(obj,newObj);}return newObj;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=(0,_getPrototypeOf2.default)(Derived),result;if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2.default)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return(0,_possibleConstructorReturn2.default)(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}var DIRECTION={DOWN:'down',LEFT:'left',RIGHT:'right',UP:'up'};var POSITION={BOTTOM_LEFT:'bottomLeft',BOTTOM_RIGHT:'bottomRight',TOP_LEFT:'topLeft',TOP_RIGHT:'topRight'};var AnimatedFab=_reactNative.Animated.createAnimatedComponent(_Button.Button);var Fab=function(_Component){(0,_inherits2.default)(Fab,_Component);var _super=_createSuper(Fab);function Fab(props){var _this;(0,_classCallCheck2.default)(this,Fab);_this=_super.call(this,props);_this.prepareButtonProps=function(child){var inp=(0,_lodash.clone)(child.props);delete inp.style;var defaultProps={};return(0,_computeProps.default)(inp,defaultProps);};_this.fabTopValue=function(pos){if(pos===POSITION.TOP_LEFT){return{top:_platform.default.fabDefaultPosition,bottom:undefined,left:_platform.default.fabDefaultPosition,right:undefined};}else if(pos===POSITION.BOTTOM_RIGHT){return{top:undefined,bottom:_platform.default.fabDefaultPosition,left:undefined,right:_platform.default.fabDefaultPosition};}else if(pos===POSITION.BOTTOM_LEFT){return{top:undefined,bottom:_platform.default.fabDefaultPosition,left:_platform.default.fabDefaultPosition,right:undefined};}else if(pos===POSITION.TOP_RIGHT){return{top:_platform.default.fabDefaultPosition,bottom:undefined,left:undefined,right:_platform.default.fabDefaultPosition};}return null;};_this.containerHeight=new _reactNative.Animated.Value(_platform.default.fabWidth);_this.containerWidth=new _reactNative.Animated.Value(0);_this.buttonScale=new _reactNative.Animated.Value(0);_this.state={buttons:undefined,active:false};return _this;}(0,_createClass2.default)(Fab,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;var childrenArray=_react.default.Children.toArray(this.props.children);var icon=(0,_lodash.remove)(childrenArray,function(item){if(item.type.displayName==='Styled(Button)'){return true;}return null;});this.setState({buttons:icon.length});this.activeTimer=setTimeout(function(){_this2.setState({active:_this2.props.active});},0);}},{key:"componentWillUnmount",value:function componentWillUnmount(){if(this.activeTimer){clearTimeout(this.activeTimer);}}},{key:"getOtherButtonStyle",value:function getOtherButtonStyle(child,i){var _this$props=this.props,active=_this$props.active,direction=_this$props.direction;var type={top:direction?this.fabOtherBtns(direction,i).top:undefined,left:direction?this.fabOtherBtns(direction,i).left:8,right:direction?this.fabOtherBtns(direction,i).right:0,bottom:direction?this.fabOtherBtns(direction,i).bottom:active===false?_reactNative.Platform.OS===_commonColor.PLATFORM.IOS?8:8:i*50+50};return(0,_lodash.merge)(this.getInitialStyle().buttonStyle,_reactNative.StyleSheet.flatten(child.props.style),type);}},{key:"getContainerStyle",value:function getContainerStyle(){return(0,_lodash.merge)(this.getInitialStyle().container,this.props.containerStyle);}},{key:"getInitialStyle",value:function getInitialStyle(iconStyle){var _this$props2=this.props,direction=_this$props2.direction,position=_this$props2.position;return{fab:{height:_platform.default.fabWidth,width:_platform.default.fabWidth,borderRadius:_platform.default.fabBorderRadius,elevation:_platform.default.fabElevation,shadowColor:_platform.default.fabShadowColor,shadowOffset:{width:_platform.default.fabShadowOffsetWidth,height:_platform.default.fabShadowOffsetHeight},shadowOpacity:_platform.default.fabShadowOpacity,justifyContent:'center',alignItems:'center',shadowRadius:_platform.default.fabShadowRadius,position:'absolute',bottom:_platform.default.fabBottom,backgroundColor:_platform.default.fabBackgroundColor},container:{position:'absolute',top:position?this.fabTopValue(position).top:undefined,bottom:position?this.fabTopValue(position).bottom:_platform.default.fabContainerBottom,right:position?this.fabTopValue(position).right:_platform.default.fabContainerBottom,left:position?this.fabTopValue(position).left:undefined,width:_platform.default.fabWidth,height:this.containerHeight,flexDirection:direction?direction===DIRECTION.LEFT||direction===DIRECTION.RIGHT?'row':'column':'column',alignItems:'center'},iconStyle:(0,_extends2.default)({color:_platform.default.fabIconColor,fontSize:_platform.default.fabIconSize,lineHeight:_reactNative.Platform.OS===_commonColor.PLATFORM.IOS?27:undefined},iconStyle),buttonStyle:{position:'absolute',height:_platform.default.fabButtonHeight,width:_platform.default.fabButtonHeight,left:_platform.default.fabButtonLeft,borderRadius:_platform.default.fabButtonBorderRadius,transform:this.state.active?[{scale:new _reactNative.Animated.Value(1)}]:[{scale:this.buttonScale}],marginBottom:_platform.default.fabButtonMarginBottom,backgroundColor:_platform.default.fabBackgroundColor}};}},{key:"fabOtherBtns",value:function fabOtherBtns(direction,i){var active=this.props.active;if(direction===DIRECTION.UP){return{top:undefined,bottom:active===false?_reactNative.Platform.OS===_commonColor.PLATFORM.IOS?50:5:i*50+65,left:8,right:0};}else if(direction===DIRECTION.LEFT){return{top:8,bottom:0,left:active===false?_reactNative.Platform.OS===_commonColor.PLATFORM.IOS?8:8:-(i*50+_platform.default.fabWidth+2),right:0};}else if(direction===DIRECTION.DOWN){return{top:active===false?_reactNative.Platform.OS===_commonColor.PLATFORM.IOS?50:8:i*50+73,bottom:0,left:8,right:0};}else if(direction===DIRECTION.RIGHT){return{top:8,bottom:0,left:active===false?_reactNative.Platform.OS===_commonColor.PLATFORM.IOS?50:8:i*50+73,right:0};}return null;}},{key:"prepareFabProps",value:function prepareFabProps(){var defaultProps={style:this.getInitialStyle().fab};var incomingProps=(0,_lodash.clone)(this.props);delete incomingProps.onPress;return(0,_computeProps.default)(incomingProps,defaultProps);}},{key:"upAnimate",value:function upAnimate(){if(!this.props.active){_reactNative.Animated.spring(this.containerHeight,{toValue:this.state.buttons*51.3+_platform.default.fabWidth,useNativeDriver:false}).start();_reactNative.Animated.spring(this.buttonScale,{toValue:1,useNativeDriver:true}).start();}else{this.setState({active:false});_reactNative.Animated.spring(this.containerHeight,{toValue:_platform.default.fabWidth,useNativeDriver:false}).start();_reactNative.Animated.spring(this.buttonScale,{toValue:0,useNativeDriver:true}).start();}}},{key:"leftAnimate",value:function leftAnimate(){if(!this.props.active){_reactNative.Animated.spring(this.containerWidth,{toValue:this.state.buttons*51.3+_platform.default.fabWidth,useNativeDriver:false}).start();_reactNative.Animated.spring(this.buttonScale,{toValue:1,useNativeDriver:true}).start();}else{this.setState({active:false});_reactNative.Animated.spring(this.containerHeight,{toValue:_platform.default.fabWidth,useNativeDriver:false}).start();_reactNative.Animated.spring(this.buttonScale,{toValue:0,useNativeDriver:true}).start();}}},{key:"rightAnimate",value:function rightAnimate(){if(!this.props.active){_reactNative.Animated.spring(this.containerWidth,{toValue:this.state.buttons*51.3+_platform.default.fabWidth,useNativeDriver:false}).start();_reactNative.Animated.spring(this.buttonScale,{toValue:1,useNativeDriver:true}).start();}else{this.setState({active:false});_reactNative.Animated.spring(this.containerHeight,{toValue:_platform.default.fabWidth,useNativeDriver:false}).start();_reactNative.Animated.spring(this.buttonScale,{toValue:0,useNativeDriver:true}).start();}}},{key:"downAnimate",value:function downAnimate(){if(!this.props.active){_reactNative.Animated.spring(this.containerHeight,{toValue:_platform.default.fabWidth,useNativeDriver:false}).start();_reactNative.Animated.spring(this.buttonScale,{toValue:1,useNativeDriver:true}).start();}else{this.setState({active:false});_reactNative.Animated.spring(this.containerHeight,{toValue:_platform.default.fabWidth,useNativeDriver:false}).start();_reactNative.Animated.spring(this.buttonScale,{toValue:0,useNativeDriver:true}).start();}}},{key:"_animate",value:function _animate(){var _this$props3=this.props,direction=_this$props3.direction,position=_this$props3.position;if(direction){if(direction===DIRECTION.UP){if(position===POSITION.TOP_LEFT||position===POSITION.TOP_RIGHT){console.warn('Passing direction = up with position = topLeft/topRight is not suggested.');}else{this.upAnimate();}}else if(direction===DIRECTION.LEFT){if(position===POSITION.TOP_LEFT||position===POSITION.BOTTOM_LEFT){console.warn('Passing direction = left with position = topLeft/bottomLeft is not suggested.');}else{this.leftAnimate();}}else if(direction===DIRECTION.RIGHT){if(position===POSITION.TOP_RIGHT||position===POSITION.BOTTOM_RIGHT){console.warn('Passing direction = right with position = topRight/bottomRight is not suggested.');}else{this.rightAnimate();}}else if(direction===DIRECTION.DOWN){if(position===POSITION.BOTTOM_LEFT||position===POSITION.BOTTOM_RIGHT){console.warn('Passing direction = down with position = bottomLeft/bottomRight is not suggested.');}else{this.downAnimate();}}}else{this.upAnimate();}}},{key:"fabOnPress",value:function fabOnPress(){var _this3=this;if(this.props.onPress){this.props.onPress();this._animate();this.activeTimer=setTimeout(function(){_this3.setState({active:_this3.props.active});},100);}}},{key:"renderButtons",value:function renderButtons(){var _this4=this;var childrenArray=_react.default.Children.toArray(this.props.children);var newChildren=[];childrenArray.slice(1).map(function(child,i){return newChildren.push(_react.default.createElement(AnimatedFab,(0,_extends2.default)({style:_this4.getOtherButtonStyle(child,i)},_this4.prepareButtonProps(child,i),{fabButton:true,key:i,__self:_this4,__source:{fileName:_jsxFileName,lineNumber:434,columnNumber:9}}),child.props.children));});return newChildren;}},{key:"renderFab",value:function renderFab(){var childrenArray=_react.default.Children.toArray(this.props.children);(0,_lodash.remove)(childrenArray,function(item){if(item.type.displayName==='Styled(Button)'){return true;}return null;});return _react.default.cloneElement(childrenArray[0],{style:this.getInitialStyle(childrenArray[0].props.style).iconStyle});}},{key:"render",value:function render(){var _this5=this;var style=this.props.style;return _react.default.createElement(_reactNative.Animated.View,{style:this.getContainerStyle(),__self:this,__source:{fileName:_jsxFileName,lineNumber:462,columnNumber:7}},this.renderButtons(),_reactNative.Platform.OS===_commonColor.PLATFORM.IOS||_platform.default.androidRipple===false||_reactNative.Platform.Version<=21?_react.default.createElement(_reactNative.TouchableOpacity,(0,_extends2.default)({onPress:function onPress(){return _this5.fabOnPress();}},this.prepareFabProps(),{activeOpacity:1,__self:this,__source:{fileName:_jsxFileName,lineNumber:467,columnNumber:11}}),this.renderFab()):_react.default.createElement(_reactNative.TouchableNativeFeedback,(0,_extends2.default)({onPress:function onPress(){return _this5.fabOnPress();},background:_reactNative.TouchableNativeFeedback.Ripple(_platform.default.androidRippleColor,false)},this.prepareFabProps(),{__self:this,__source:{fileName:_jsxFileName,lineNumber:474,columnNumber:11}}),_react.default.createElement(_reactNative.View,{style:[this.getInitialStyle().fab,style],__self:this,__source:{fileName:_jsxFileName,lineNumber:481,columnNumber:13}},this.renderFab())));}}]);return Fab;}(_react.Component);var StyledFab=(0,_shoutem.connectStyle)('NativeBase.Fab',{},_mapPropsToStyleNames.default)(Fab);exports.Fab=StyledFab;
//# sourceMappingURL=Fab.js.map